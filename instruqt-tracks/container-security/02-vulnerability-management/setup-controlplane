#!/bin/bash

kubectl patch felixconfiguration.p default -p '{"spec":{"flowLogsFlushInterval":"10s"}}'
kubectl patch felixconfiguration.p default -p '{"spec":{"dnsLogsFlushInterval":"10s"}}'
kubectl patch felixconfiguration.p default -p '{"spec":{"flowLogsFileAggregationKindForAllowed":1}}'

#install docker 
apt  install docker.io -y

#install tigera scaner 
curl -Lo tigera-scanner https://installer.calicocloud.io/tigera-scanner/v3.14.1-9/image-assurance-scanner-cli-linux-amd64
chmod +x ./tigera-scanner


# Deploy compliance reports 
kubectl apply -f https://raw.githubusercontent.com/JosephYostos/Compliance-workshop/main/04-Reports-Visualization/%20mainfest/daily-cis-results.yaml
kubectl apply -f https://raw.githubusercontent.com/JosephYostos/Compliance-workshop/main/04-Reports-Visualization/%20mainfest/cluster-reports.yaml

# pull adservice v0.3.2
#docker image pull tigeralabs.azurecr.io/boutiqueshop-demo/adservice:v0.3.2. 
docker image pull myappimages.azurecr.io/virtualreality:latest
